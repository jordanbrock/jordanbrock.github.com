<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CoffeeScript, bistro_car, homebrew, and passenger gotcha &mdash; jordanbrock.com </title>
    <link href="/css/reset.css" rel="stylesheet" type="text/css" />
    <link href="/css/screen.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/css/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <link rel="openid.server" href="http://openid.claimid.com/server">
    <link rel="openid.delegate" href="http://openid.claimid.com/jordanbrock">
    <script type="text/javascript" src="http://use.typekit.com/wmw7icf.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '4f8d0d2df5a1f54576000010');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

  </head>
  <body>
    <div id="container">
      <header>
      <h1><a href="/">Jordan Brock</a></h1>
      </header>
      <div id="content">
        <h2>CoffeeScript, bistro_car, homebrew, and passenger gotcha</h2>
<time class="meta" datetime="2010-04-08">
  Apr 08, 2010
</time>
<article class="post">
  <p>File under &#8220;Things for me to remember when reinstalling stuff&#8221;</p>
<p>For me, one of the best things about using Ruby/Rails/Sinatra for web development is <span class="caps">HAML</span>/<span class="caps">SASS</span>, which allow me to quickly write and maintain <span class="caps">HTML</span>/<span class="caps">CSS</span> without having to worry about all the pointless stuff, like brackets etc. A by-product of using <span class="caps">HAML</span>/<span class="caps">SASS</span> is that when you have to write in something else, it causes me grief. JavaScript is a case in point.</p>
<p>Coffeescript (and to a lesser extent) bistro_car solve this. It brings the beauty of a ruby-like language to writing JavaScript, so that once again you don&#8217;t have to worry about all the crap that goes along with it.</p>
<p>However, I ran into a slight problem when following <a href="http://drnicwilliams.com/2010/03/15/using-coffeescript-in-rails-and-even-on-heroku/">Dr Nic&#8217;s setup tutorial</a> today. <a href="http://jashkenas.github.com/coffee-script/">CoffeeScript</a> worked, <a href="http://github.com/jnicklas/bistro_car">bistro_car</a> worked within the console, but it didn&#8217;t work when accessing the page through the browser. But some path re-working, and a kind word or two from <a href="http://twitter.com/sutto">@sutto</a>, and we&#8217;re good to go.</p>
<p>For future reference, here&#8217;s what I did. I&#8217;m using the <a href="http://github.com/mxcl/homebrew">homebrew package manager</a>. Mainly because it&#8217;s awesome, and I use MacOS X, which is also awesome.</p>
<p>So, I installed node.js, coffeescript and bistro_car like so:</p>
<div class="highlight"><pre><code class="bash">brew install node
brew install coffee-script
gem install bistro_car
</code></pre>
</div>
<p>Then, add the following to your environment.rb file:</p>
<div class="highlight"><pre><code class="ruby"><span class="n">config</span><span class="o">.</span><span class="n">gem</span> <span class="s1">&#39;bistro_car&#39;</span>
</code></pre>
</div>
<p>Create an &#8216;app/scripts&#8217; directory in your Rails app, which is where you can store all your .coffee files (application.coffee etc).</p>
<p>You then get bistro_car to include those script files by putting this in your layout/template/page/whatever:</p>
<div class="highlight"><pre><code class="ruby"><span class="n">coffee_script_bundle</span>
</code></pre>
</div>
<p>Then, you load the page, and bistro_car automagically uses coffee-script to convert your .coffee files to javascript. Except, of course, when it doesn&#8217;t work because something is screwed somewhere.</p>
<p>As with almost every problem on a *nix computer, the problem is a path one, and thankfully solved with some simple symlinks. It seems <a href="http://www.modrails.com/">passenger</a> operates in it&#8217;s own little world when it comes to paths, and it just didn&#8217;t want to play nice with my environment. So, I tricked it as follows:</p>
<div class="highlight"><pre><code class="bash">sudo ln -s /usr/local/bin/coffee /usr/bin/coffee
sudo ln -s /usr/local/bin/node /usr/bin/node
</code></pre>
</div>
<p>And that, my friend, is how you skin the unix path cat.</p>
</article>

      </div>
      <div id="sidebar">
        <h2>Stuff</h2>
        <ul>
          <li><a href="/archive.html">Archive</a></li>
          <li><a href="http://photos.jordanbrock.com">OpenPhoto</a></li>
          <li><a href="http://twitter.com/jordanbrock">twitter</a></li>
          <li><a href="http://strava.com/athletes/jordanbrock">Strava</a></li>
        </ul>
      </div>
      <footer>
        By me.
      </footer>
    </div>
  </body>
</html>
