<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>jordanbrock.com &mdash; Easy comma delimited files</title>
    <link href="/css/reset.css" rel="stylesheet" type="text/css" />
    <link href="/css/screen.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/css/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <link rel="openid.server" href="http://openid.claimid.com/server">
    <link rel="openid.delegate" href="http://openid.claimid.com/jordanbrock">
    <script type="text/javascript" src="http://use.typekit.com/wmw7icf.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '4f8d0d2df5a1f54576000010');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

  </head>
  <body>
    <div id="container">
      <header>
      <h1><a href="/">Jordan Brock</a></h1>
      </header>
      <div id="content">
        <h2>Easy comma delimited files</h2>
<time class="meta" datetime="2006-01-18">
  Jan 18, 2006
</time>
<article class="post">
  <p>From <a href="http://habtm.com/articles/2006/01/18/insta_export">~:caboose</a></p>
<pre>
  # this is used directly on models only
  # Usage: Customer.to_tab_delimited
  def self.to_tab_delimited(path = nil, columns = nil, options = nil)
    columns ||= self.column_names
    File.open(File.expand_path(path || "./#{table_name}.txt", RAILS_ROOT), 'w') do |file|
      file.puts(columns.join("\t"))
      # Notice this is very close to what the Array#to_tab_delimited below does, except Array only calls itself, meaning
      # it only exports it's own contents. 
      self.find(:all, options).each do |rec| 
        row = columns.inject([]) do |arr, col|
          if rec[col].is_a?(String)
            arr &lt;&lt; rec[col].gsub(/[\t\n]/, ' ')
          else
            arr &lt;&lt; rec[col]
          end
        end
        file.puts(row.join("\t"))
      end
    end
  end
end
</pre>
</article>

      </div>
      <div id="sidebar">
        <h2>Stuff</h2>
        <ul>
          <li><a href="/archive.html">Archive</a></li>
          <li><a href="http://photos.jordanbrock.com">OpenPhoto</a></li>
          <li><a href="http://twitter.com/jordanbrock">twitter</a></li>
          <li><a href="http://strava.com/athletes/jordanbrock">Strava</a></li>
        </ul>
      </div>
      <footer>
        By me.
      </footer>
    </div>
  </body>
</html>
